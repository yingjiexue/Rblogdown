<script type="text/javascript"
src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>ETF持股影响股票定价效率的理论模型推导 - Yingjie</title>
    <meta property="og:title" content="ETF持股影响股票定价效率的理论模型推导 - Yingjie">
    
    <meta name="twitter:card" content="summary">

    
      
    

    
      
      <meta property="description" content="定价效率是证券价格反映信息的能力，表现在股价反映信息的速度和准确性上（Saffi and Sigurdsson，2011）。关于证券市场信息与定价效率的关系在理论界已做出了充分的研究，提出了有效市场理论、金融市场噪声理论和交易摩擦理论等。目前，学术界普遍认为，ETF主要通过交易成本和限制等市场摩擦影响成分股的定价效率。与发达市场不同，A股市场各项制度和规则不够完善，交易成本较高，卖空限制严重，散户 &amp;hellip;">
      <meta property="og:description" content="定价效率是证券价格反映信息的能力，表现在股价反映信息的速度和准确性上（Saffi and Sigurdsson，2011）。关于证券市场信息与定价效率的关系在理论界已做出了充分的研究，提出了有效市场理论、金融市场噪声理论和交易摩擦理论等。目前，学术界普遍认为，ETF主要通过交易成本和限制等市场摩擦影响成分股的定价效率。与发达市场不同，A股市场各项制度和规则不够完善，交易成本较高，卖空限制严重，散户 &amp;hellip;">
      
    

    
    

    

    
    


<link href='//yingjie.org/highlight.js/9.11.0/styles/github.min.css' rel='stylesheet' type='text/css' />



    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  
  <body class="research">
    <header class="masthead">
      <h1><a href="/">Yingjie</a></h1>



      <nav class="menu">
  <input id="menu-check" type="checkbox" />
  <label id="menu-label" for="menu-check" class="unselectable">
    <span class="icon close-icon">✕</span>
    <span class="icon open-icon">☰</span>
    <span class="text">Menu</span>
  </label>
  <ul>
  
  
  <li><a href="/">主页</a></li>
  
  <li><a href="/cn/">日志</a></li>
  
  <li><a href="/research/">研究</a></li>
  
  <li><a href="/cn_about/">关于</a></li>
  
  <li><a href="/en/">Blog</a></li>
  
  <li><a href="/en_about/">About</a></li>
  
  
  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      
<h1>ETF持股影响股票定价效率的理论模型推导</h1>

<h3>
  2021-01-14</h3>
<hr>


      </header>






<div id="机理分析" class="section level3">
<h3>机理分析</h3>
<p>定价效率是证券价格反映信息的能力，表现在股价反映信息的速度和准确性上（Saffi and Sigurdsson，2011）。关于证券市场信息与定价效率的关系在理论界已做出了充分的研究，提出了有效市场理论、金融市场噪声理论和交易摩擦理论等。目前，学术界普遍认为，ETF主要通过交易成本和限制等市场摩擦影响成分股的定价效率。与发达市场不同，A股市场各项制度和规则不够完善，交易成本较高，卖空限制严重，散户投资者持有市场88%的流通股（Liu et al.，2019），这都会影响定价效率。而且，高效价格发现机制的形成，离不开发达的信息中介机构和相对成熟的投资者群体（朱红军等，2008），中介机构的信息生产和挖掘能力也是影响定价效率的重要因素。因此，我们认为交易成本、卖空限制和信息挖掘三种是ETF影响定价效率的中介渠道。</p>
</div>
<div id="模型建立" class="section level3">
<h3>模型建立</h3>
<p>我们的模型尝试捕获证券市场的四个主要特征：（1）投资者异质性，（2）交易成本非零，（3）卖空存在限制，（4）知情投资者主动挖掘市场信息。投资者异质性体现在投资者的风险承担和关于未来资产回报信息上的差异，他们出于承担风险和信息投机的目的而交易。</p>
<blockquote>
<p>证券市场</p>
</blockquote>
<p>市场持续存在两期，分别为0期与1期，投资者在竞争的证券市场上交易，可交易的产品有无风险债券、股票和ETF基金，在1期，投资者获得投资收益，假定每单位债券的固定收益为1，股票价值为<span class="math inline">\(V=F+\mu\)</span>，其中<span class="math inline">\(\mu\)</span>和<span class="math inline">\(F\)</span>分别为相互独立的均匀分布，<span class="math inline">\(F\sim U[-a_F,a_F]\)</span>，<span class="math inline">\(\mu\sim U[-a_\mu,a_\mu]\)</span></p>
<blockquote>
<p>投资者</p>
</blockquote>
<p>市场上有两类投资者，一类为知情投资者，另一类为非知情投资者，每一类投资者完全相同，而且知情投资者与非知情投资者面临的信息不同，知情交易者掌握其投资资产的所有信息，非知情交易者通过资产价格来推断该资产价值相关的信息，假设一个投资者为知情交易者的概率为<span class="math inline">\(w\)</span>，则为非知情交易者的概率为<span class="math inline">\(1-w\)</span>。</p>
<blockquote>
<p>禀赋</p>
</blockquote>
<p>每位投资者<span class="math inline">\(i（i=I,U）\)</span>初始的债券禀赋为零，<span class="math inline">\(\bar\theta\)</span>单位的股票资产，投资者通过选择1期持股有的股票量<span class="math inline">\(\theta_i\)</span>来最大化期望效用</p>
<blockquote>
<p>信息结构</p>
</blockquote>
<p>在0期，知情投资者观察到私有信息<span class="math inline">\(F\)</span>，所有投资者都能观察到股票的市场价格<span class="math inline">\(P\)</span>，这样知情投资者的信息集为<span class="math inline">\(I_I=\{F,P\}\)</span>，非知情交易者的信息集为<span class="math inline">\(I_U=\{P\}\)</span>，在1期所有不确定性都被消除。</p>
<blockquote>
<p>财富及效用函数</p>
</blockquote>
<p>每一位投资者都是风险厌恶者，其对效用函数为Markowiz-Tobin均值方差函数，让<span class="math inline">\(\theta_i\)</span>表示投资者<span class="math inline">\(i\)</span>最有持股，<span class="math inline">\(w_i\)</span>为投资者<span class="math inline">\(i\)</span>在1期的最终财富，具体公式如下：</p>
<p><span class="math display">\[W_i=\bar\theta P+\theta_i(V-P)\]</span></p>
<p>投资者效用函数为：</p>
<p><span class="math display">\[E[W_i|I_i]-\frac{1}{2}Var[W_i|I_i]\]</span></p>
<blockquote>
<p><strong>ETF持股作为外生冲击，通过交易成本、卖空限制，信息挖掘三种渠道来影响投资的决策行为。交易成本主要影响投资者从股票价格获取信息的准确性，卖空限制影响投资者对资产的需求，信息挖掘影响投资者成为知情投资的概率，ETF持股比例越高，股票交易成本越低，卖空限制越小，信息挖掘越充分，投资者成为知情交易者的概率越高，从股票价格中获取的信息越准确。</strong>假设ETF持有股票i的市值比例为<span class="math inline">\(\eta\)</span>，则投资者成为知情交易者的概率<span class="math inline">\(w\)</span>是ETF持股比例的增函数，卖空限制和交易成本是ETF持股比例的减函数。</p>
</blockquote>
</div>
<div id="模型求解" class="section level3">
<h3>模型求解</h3>
<blockquote>
<p>投资者最大化期望效用，具体如下：</p>
</blockquote>
<p><span class="math display">\[Max \hspace{0.4cm} E[W_i|I_i]-\frac{1}{2}Var[W_i|I_i] \hspace{0.4cm}i=I,U\\
s.t \hspace{0.4cm} W_i=\bar\theta P+\theta_i(V-P)\]</span></p>
<p>由于<span class="math inline">\(E[W_i|I_i]=\bar\theta P+\theta_i(E[F|I_i]-P)\)</span>,<span class="math inline">\(Var[W_i|I_i]=\theta_i^2(Var[F|I_i]+\sigma_u^2)\)</span>,则投资者的效用为：</p>
<p><span class="math display">\[U_i(W_i)=\bar\theta P+\theta_i(E[F|I_i]-P)-\frac{1}{2}\theta_i^2(Var[F|I_i]+\sigma_u^2)\]</span>
一阶条件为：</p>
<p><span class="math display">\[\frac{\partial U_i}{\partial \theta_i}=(E[F|I_i]-P)-\theta_i(Var[F|I_i]+\sigma_u^2)=0\]</span>
<span class="math display">\[\theta_i=\frac{E[F|I_i]-P}{Var[F|I_i]+\sigma_u^2}\]</span></p>
<blockquote>
<p>(1)投资者信息对称</p>
</blockquote>
<p>在信息对称条件下，<span class="math inline">\(P\)</span>、<span class="math inline">\(F\)</span>均为公开信息，投资者的交易成本为0，知情交易者与非知情交易者面临相同的信息集，即<span class="math inline">\(I_u=I_I=\{F,P\}\)</span>，此时，<span class="math inline">\(E[F|I_I]=E[F|I_U]=F\)</span>,<span class="math inline">\(Var[F|I_I]=Var[F|I_U]=0\)</span>。</p>
<p>投资者的需求函数为：</p>
<p><span class="math display">\[\theta_I=\theta_U=\frac{F-P}{\sigma_u^2}\]</span></p>
<p>均衡价格为：</p>
<p><span class="math display">\[P^\star=F-\sigma_u^2\bar\theta\]</span></p>
<blockquote>
<p>(2)信息不对称</p>
</blockquote>
<p>当信息不对称时，两类投资者掌握的信息不同，知情投资者掌握股票价值和价格信息，非知情投资者掌握价格信息，只能通过价格来推断资产价值信息。由于信息不对称条件下，求解比较复杂，参考Yang Bai et al.研究，我们先猜测一种均衡下的价格函数，在此价格函数下推导出投资者的需求，并证明在此均衡价格下市场出清。我们认为股票价格取决于经济状态变量，受交易成本和噪声影响，且股票价格只取决于信号<span class="math inline">\(S=\frac{1}{2}(F-c\varepsilon)\)</span>，股票价格是<span class="math inline">\(S\)</span>的严格增函数。其中，<span class="math inline">\(\varepsilon \sim U[-a_F,a_F]\)</span>，<span class="math inline">\(0&lt; c\leq 1\)</span>，S。</p>
<p>对于知情交易者来说，在信息集<span class="math inline">\(I=\{F,P\}\)</span>下的需求函数为：</p>
<p><span class="math display">\[\theta_I==\frac{F-P}{\sigma_u^2}\]</span></p>
<p>对于非知情交易者来说，在信息集<span class="math inline">\(I=\{P\}\)</span>下，<span class="math inline">\(E[F|I_U]=E[F|P]=E[F|S]\)</span>，<span class="math inline">\(Var[F|I_U]=Var[F|P]=Var[F|S]\)</span>。由于<span class="math inline">\(c\varepsilon\)</span>与<span class="math inline">\(F\)</span>独立同分布，则其联合密度函数为<span class="math inline">\(f(F,\varepsilon)=f_F(F)f_{\varepsilon}(\varepsilon)\)</span>，且<span class="math inline">\(\varepsilon=\frac{F-2S}{c}\)</span>，则<span class="math inline">\(S\)</span>的概率密度函数为：</p>
<p><span class="math display">\[f(S)=\int f(F,\frac{F-2S}{c})dF=\int f_F(F)f_{\varepsilon}(\frac{F-2S}{c})dF\\
 \hspace{5cm}=\frac{1}{4a_F^2}\int I[-a_F&lt;F&lt;a_F]I[-ca_F+2S&lt;F&lt;ca_F+2S]dF\]</span></p>
<p>由于<span class="math inline">\(F\)</span>同时属于区间<span class="math inline">\([-a_F&lt;F&lt;a_F]\)</span>和<span class="math inline">\([-ca_F+2S&lt;F&lt;ca_F+2S]\)</span>，则需要取其交集，对<span class="math inline">\(S\)</span>进行讨论。</p>
<p>当<span class="math inline">\(S\ge\frac{(1-c)a_F}{2}\)</span>时，<span class="math inline">\(F\in [-ca_F+2S,a_F]\)</span>，则</p>
<p><span class="math display">\[f(S)=\frac{1}{4a_F^2}\int _{-ca_F+2S}^{a_F}dF=\frac{(1+c)a_F-2S}{4a_F^2}\]</span></p>
<p>当<span class="math inline">\(S\le-\frac{(1-c)a_F}{2}\)</span>时，<span class="math inline">\(F\in [-a_F,ca_F+2S]\)</span>，则</p>
<p><span class="math display">\[f(S)=\frac{1}{4a_F^2}\int _{-a_F}^{ca_F+2S}dF=\frac{(1+c)a_F+2S}{4a_F^2}\]</span>
当<span class="math inline">\(-\frac{(1-c)a_F}{2}&lt;S&lt;\frac{(1-c)a_F}{2}\)</span>时，<span class="math inline">\(F\in [-ca_F+2S,ca_F+2S]\)</span>，则</p>
<p><span class="math display">\[f(S)=\frac{1}{4a_F^2}\int _{-ca_F+2S}^{ca_F+2S}dF=\frac{2ca_F}{4a_F^2}\]</span></p>
<p>因此，我们便可求得条件概率密度函数，具体如下：</p>
<p><span class="math display">\[\begin{equation}
f(F|S)=f(F,F-2S)/f(S)=\left\{
\begin{aligned}
&amp;\frac{1}{(1+c)a_F-2S}I[-ca_F+2S,a_F](F),\hspace{0.5cm}S\ge\frac{(1-c)a_F}{2} \\
&amp;\frac{1}{2ca_F}I[-ca_F+2S,ca_F+2S](F),\hspace{0.5cm}\frac{(1-c)a_F}{2}\ge S\ge-\frac{(1-c)a_F}{2} \\
&amp;\frac{1}{(1+c)a_F+2S}I[-a_F,ca_F+2S](F),\hspace{0.5cm}S\le-\frac{(1-c)a_F}{2} 
\end{aligned}
\right.
\end{equation}\]</span></p>
<p>求得条件均值与条件方差如下：</p>
<p><span class="math display">\[\begin{equation}
E[F|S]=\int Ff(F|S)dF=\left\{
\begin{aligned}
&amp;\frac{1}{(1+c)a_F-2S}\int _{-ca_F+2S}^{a_F}FdF,\hspace{0.5cm} \frac{(1-c)a_F}{2}\le S \le \frac{(1+c)a_F}{2} \\
&amp;\frac{1}{2ca_F}\int _{-ca_F+2S}^{ca_F+2S}FdF,\hspace{0.5cm}-\frac{(1-c)a_F}{2}&lt; S &lt;\frac{(1-c)a_F}{2} \\
&amp;\frac{1}{(1+c)a_F+2S}\int _{-a_F}^{ca_F+2S}FdF,\hspace{0.5cm}-\frac{(1+c)a_F}{2}\le S\le-\frac{(1-c)a_F}{2}  
\end{aligned}
\right.\\ \hspace{2cm}
=\left\{
\begin{aligned}
&amp;\frac{(1-c)a_F+2S}{2},\hspace{0.5cm}\frac{(1-c)a_F}{2}\le S \le \frac{(1+c)a_F}{2}\\
&amp;2S,\hspace{0.5cm}-\frac{(1-c)a_F}{2}&lt; S&lt; \frac{(1-c)a_F}{2}\\
&amp;\frac{2S-(1-c)a_F}{2},\hspace{0.5cm}-\frac{(1+c)a_F}{2}\le S\le-\frac{(1-c)a_F}{2}  
\end{aligned}
\right.
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
E[F^2|S]=\int F^2f(F|S)dF=\left\{
\begin{aligned}
&amp;\frac{1}{(1+c)a_F-2S}\int _{-ca_F+2S}^{a_F}F^2dF,\hspace{1cm}\frac{(1-c)a_F}{2}\le S \le \frac{(1+c)a_F}{2} \\
&amp;\frac{1}{2ca_F}\int _{-ca_F+2S}^{ca_F+2S}F^2dF,\hspace{0.5cm}-\frac{(1-c)a_F}{2}&lt; S&lt;\frac{(1-c)a_F}{2} \\
&amp;\frac{1}{(1+c)a_F+2S)}\int _{-a_F}^{ca_F+2S}F^2dF,\hspace{1cm}- \frac{(1+c)a_F}{2}\le S\le-\frac{(1-c)a_F}{2}  
\end{aligned}
\right.\\ \hspace{8cm}
=\left\{
\begin{aligned}
&amp;\frac{(1+c^2-c)a_F^2+2(1-2c)a_FS+4S^2}{3},\hspace{1cm}\frac{(1-c)a_F}{2}\le S \le \frac{(1+c)a_F}{2}  \\
&amp;4S^2+c^2a_F^2/3,\hspace{7cm}-\frac{(1-c)a_F}{2}&lt; S &lt;\frac{(1-c)a_F}{2} \\
&amp;\frac{(1+c^2-c)a_F^2-2(1-2c)a_FS+4S^2}{3},\hspace{1cm}-\frac{(1+c)a_F}{2}\le S\le-\frac{(1-c)a_F}{2}  
\end{aligned}
\right.
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
V[F|S]
=\left\{
\begin{aligned}
&amp;\frac{[(1+c)a_F-2S]^2}{12},\hspace{1cm}\frac{(1-c)a_F}{2}\le S \le \frac{(1+c)a_F}{2}\\
&amp;c^2a_F^2/3,\hspace{3.5cm}-\frac{(1-c)a_F}{2}&lt; S&lt;\frac{(1-c)a_F}{2} \\
&amp;\frac{[(1+c)a_F+2S]^2}{12},\hspace{1cm}-\frac{(1+c)a_F}{2}\le S\le-\frac{(1-c)a_F}{2}  
\end{aligned}
\right.
\end{equation}\]</span></p>
<p>定价效率条件均值与方差模拟，参数设定，<span class="math inline">\(a_u=a_F=2\)</span>，<span class="math inline">\(\theta=0.1\)</span>，<span class="math inline">\(w=0.5\)</span>，<span class="math inline">\(c=0.01\)</span>，具体代码如下：</p>
<pre class="r"><code>library(plyr)
condmean&lt;-function(S,c,af){
  cm&lt;-NULL
  if(S&gt;=(1-c)*af/2){
    cm&lt;-((1-c)*af+2*S)/2
  }else{
    if(S&lt;=-(1-c)*af/2){
      cm&lt;-(2*S-(1-c)*af)/2
    }else{
      cm=2*S
    }
  }
  return(cm)
}

condvar&lt;-function(S,c,af){
  vr&lt;-NULL
  if(S&gt;=(1-c)*af/2){
    vr&lt;-((1+c)*af-2*S)^2/12
  }else{
    if(S&lt;=-(1-c)*af/2){
      vr&lt;-((1+c)*af+2*S)^2/12
    }else{
      vr&lt;-(2*c*af)^2/12
    }
  }
  return(vr)
}
set.seed(100)
theta=0.2
au&lt;-af&lt;-2
simamu=au^2/3
c&lt;-0.2
w=0.5
epsilon&lt;-runif(101,-2,2)
S=seq(-(1+c)*au/2,(1+c)*au/2,0.02)

plot(S,laply(S,condmean,0.8,2),type = &quot;l&quot;,ylim = c(-1.8,1.8))
lines(S,laply(S,condmean,0.04,2),col=&quot;red&quot;)</code></pre>
<p><img src="/research/2021-01-14-etf持股影响股票定价效率的理论模型推导_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<pre class="r"><code>plot(S,laply(S,condvar,0.8,2),type = &quot;l&quot;,ylim = c(-1.8,1.8))
lines(S,laply(S,condvar,0.04,2),col=&quot;red&quot;)</code></pre>
<p><img src="/research/2021-01-14-etf持股影响股票定价效率的理论模型推导_files/figure-html/unnamed-chunk-1-2.png" width="672" /></p>
<pre class="r"><code>c=seq(0,1,0.05)
plot(c,laply(c,condmean,S=-0.8,af=2),type = &quot;l&quot;)</code></pre>
<p><img src="/research/2021-01-14-etf持股影响股票定价效率的理论模型推导_files/figure-html/unnamed-chunk-1-3.png" width="672" /></p>
<pre class="r"><code>plot(c,laply(c,condvar,S=-0.8,af=2),type = &quot;l&quot;)</code></pre>
<p><img src="/research/2021-01-14-etf持股影响股票定价效率的理论模型推导_files/figure-html/unnamed-chunk-1-4.png" width="672" /></p>
<p>此时,非知情交易者的需求函数分别为
<span class="math display">\[\begin{equation}
\theta_U=\left\{
\begin{aligned}
&amp;\frac{S-P}{\frac{1}{12}[(1+c)a_F-2S]^2+\sigma_u^2},\hspace{0.5cm}\frac{(1-c)a_F}{2}\le S \le \frac{(1+c)a_F}{2}\\
&amp;\frac{S-P}{\frac{1}{3}(c^2a_F^2)+\sigma_u^2},\hspace{0.5cm}-\frac{(1-c)a_F}{2}&lt; S&lt; \frac{(1-c)a_F}{2} \\
&amp;\frac{S-P}{\frac{1}{12}[(1+c)a_F+2S]^2+\sigma_u^2},\hspace{0.5cm}-\frac{(1+c)a_F}{2}\le S\le-\frac{(1-c)a_F}{2}  
\end{aligned}
\right.
\end{equation}\]</span></p>
<p>将<span class="math inline">\(\theta_I\)</span>和<span class="math inline">\(\theta_U\)</span>代入市场出清条件<span class="math inline">\(w\theta_I+(1-w)\theta_U=\bar\theta\)</span>得</p>
<p><span class="math display">\[w\frac{F-P}{\sigma_u^2}+(1-w)\frac{S-P}{V[F|S])+\sigma_u^2}=\bar\theta\]</span>
解得均衡价格为：</p>
<p><span class="math display">\[P=2S+c\varepsilon-\bar\theta\sigma_u^2-(1-w)\frac{S+c\varepsilon+V[F|S]\bar\theta}{1+wV[F|S]/\sigma_u^2}\]</span>
即</p>
<p><span class="math display">\[\begin{equation}
P=\left\{
\begin{aligned}
&amp;2S+c\varepsilon-\bar\theta\sigma_u^2-(1-w)\frac{S+c\varepsilon+\frac{1}{12}[(1+c)a_F-2S]^2\bar\theta}{1+w\frac{1}{12}[(1+c)a_F-2S]^2/\sigma_u^2},\hspace{0.5cm} \frac{(1-c)a_F}{2}\le S \le \frac{(1+c)a_F}{2} \\
&amp;2S+c\varepsilon-\bar\theta\sigma_u^2-(1-w)\frac{S+c\varepsilon+\frac{1}{3}(c^2a_F^2)\bar\theta}{1+w\frac{1}{3}(c^2a_F^2)/\sigma_u^2},\hspace{0.5cm}-\frac{(1-c)a_F}{2}&lt; S&lt; \frac{(1-c)a_F}{2} \\
&amp;2S+c\varepsilon-\bar\theta\sigma_u^2-(1-w)\frac{S+c\varepsilon+\frac{1}{12}[(1+c)a_F+2S]^2\bar\theta}{1+w\frac{1}{12}[(1+c)a_F+2S]^2/\sigma_u^2},\hspace{0.5cm} -\frac{(1+c)a_F}{2} \le S\le-\frac{(1-c)a_F}{2}  
\end{aligned}
\right.
\end{equation}\]</span>
将均衡价格代入需求函数，得到均衡需求如下：</p>
<p><span class="math display">\[\theta_I=\bar\theta+(1-w)\frac{S+c\varepsilon+V[F|S]\bar\theta}{\sigma_u^2+wV[F|S]}\]</span>
<span class="math display">\[\theta_U=\bar\theta-w\frac{S+c\varepsilon+V[F|S]\bar\theta}{\sigma_u^2+wV[F|S]}\]</span></p>
<p>即
<span class="math display">\[\begin{equation}
\theta_I=\left\{
\begin{aligned}
&amp;\bar\theta+(1-w)\frac{S+c\varepsilon+\frac{1}{12}[(1+c)a_F-2S]^2\bar\theta}{\sigma_u^2+w\frac{1}{12}[(1+c)a_F-2S]^2},\hspace{0.5cm} \frac{(1-c)a_F}{2}\le S \le \frac{(1+c)a_F}{2} \\
&amp;\bar\theta+(1-w)\frac{S+c\varepsilon+\frac{1}{3}(c^2a_F^2)\bar\theta}{\sigma_u^2+w\frac{1}{3}(c^2a_F^2)},\hspace{0.5cm}-\frac{(1-c)a_F}{2}&lt; S&lt;\frac{(1-c)a_F}{2} \\
&amp;\bar\theta+(1-w)\frac{S+c\varepsilon+\frac{1}{12}[(1+c)a_F+2S]^2\bar\theta}{\sigma_u^2+w\frac{1}{12}[(1+c)a_F+2S]^2},\hspace{0.5cm}-\frac{(1+c)a_F}{2} \le S\le-\frac{(1-c)a_F}{2}  
\end{aligned}
\right.
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
\theta_U=\left\{
\begin{aligned}
&amp;\bar\theta-w\frac{S+c\varepsilon+\frac{1}{12}[(1+c)a_F-2S]^2\bar\theta}{\sigma_u^2+w\frac{1}{12}[(1+c)a_F-2S]^2},\hspace{0.5cm}\frac{(1-c)a_F}{2}\le S \le \frac{(1+c)a_F}{2} \\
&amp;\bar\theta-w\frac{S+c\varepsilon+\frac{1}{3}(c^2a_F^2)\bar\theta}{\sigma_u^2+w\frac{1}{3}(c^2a_F^2)},\hspace{0.5cm}-\frac{(1-c)a_F}{2}&lt; S&lt; \frac{(1-c)a_F}{2} \\
&amp;\bar\theta-w\frac{S+c\varepsilon+\frac{1}{12}[(1+c)a_F+2S]^2\bar\theta}{\sigma_u^2+w\frac{1}{12}[(1+c)a_F+2S]^2},\hspace{0.5cm}-\frac{(1+c)a_F}{2} \le S\le-\frac{(1-c)a_F}{2}  
\end{aligned}
\right.
\end{equation}\]</span></p>
</div>
<div id="均衡价格最优需求模拟" class="section level3">
<h3>均衡价格，最优需求模拟</h3>
<p>参数设定，<span class="math inline">\(a_u=a_F=2\)</span>，<span class="math inline">\(\theta=0.1\)</span>，<span class="math inline">\(w=0.5\)</span>，<span class="math inline">\(c=0.01\)</span>，具体代码如下：</p>
<pre class="r"><code>condmean&lt;-function(S,c,af){
  cm&lt;-NULL
  if(S&gt;=(1-c)*af/2){
    cm&lt;-((1-c)*af+2*S)/2
  }else{
    if(S&lt;=-(1-c)*af/2){
      cm&lt;-(2*S-(1-c)*af)/2
    }else{
      cm=2*S
    }
  }
  return(cm)
}

condvar&lt;-function(S,c,af){
  vr&lt;-NULL
  if(S&gt;=(1-c)*af/2){
    vr&lt;-((1+c)*af-2*S)^2/12
  }else{
    if(S&lt;=-(1-c)*af/2){
      vr&lt;-((1+c)*af+2*S)^2/12
    }else{
      vr&lt;-(2*c*af)^2/12
    }
  }
  return(vr)
}
set.seed(100)
theta=0.1
au&lt;-af&lt;-2
simamu=au^2/3
c=0
w=0.5
epsilon&lt;-runif(101,-2,2)
S=seq(-(1+c)*au/2,(1+c)*au/2,0.02)
VFI=laply(S,condvar,c,2)
P=2*S+c*epsilon-theta*simamu-(1-w)*((S+c*epsilon+VFI*theta)/(1+w*VFI/simamu))

plot(S,P,lty=3,type = &quot;l&quot;)</code></pre>
<p><img src="/research/2021-01-14-etf持股影响股票定价效率的理论模型推导_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>thetaI=theta+(1-w)*((S+c*epsilon+VFI*theta)/(simamu+w*VFI))
thetaU=theta-w*((S+c*epsilon+VFI*theta)/(simamu+w*VFI))

plot(S,thetaU,col=&quot;blue&quot;,lty=3,type = &quot;l&quot;)
lines(S,thetaI,col=&quot;red&quot;)
abline(h=theta,lty=3)</code></pre>
<p><img src="/research/2021-01-14-etf持股影响股票定价效率的理论模型推导_files/figure-html/unnamed-chunk-2-2.png" width="672" />
由于<span class="math inline">\(F\)</span>与<span class="math inline">\(\varepsilon\)</span>为相互独立的均匀分布<span class="math inline">\([-a_F,a_F]\)</span>，股票价格可以表示为：
<span class="math display">\[\begin{equation}
P=\left\{
\begin{aligned}
&amp;F-\bar\theta\sigma_u^2-(1-w)\frac{\frac{1}{2}(F+c\varepsilon)+\frac{1}{12}[(1+c)a_F-2S]^2\bar\theta}{1+w\frac{1}{12}[(1+c)a_F-2S]^2/\sigma_u^2},\hspace{0.5cm} (1-c)a_F+c\varepsilon\le F \le (1+c)a_F+c\varepsilon \\
&amp;F-\bar\theta\sigma_u^2-(1-w)\frac{\frac{1}{2}(F+c\varepsilon)+\frac{1}{3}(c^2a_F^2)\bar\theta}{1+w\frac{1}{3}(c^2a_F^2)/\sigma_u^2},\hspace{0.5cm}-(1-c)a_F+c\varepsilon&lt; F&lt; (1-c)a_F+c\varepsilon \\
&amp;F-\bar\theta\sigma_u^2-(1-w)\frac{\frac{1}{2}(F+c\varepsilon)+\frac{1}{12}[(1+c)a_F+2S]^2\bar\theta}{1+w\frac{1}{12}[(1+c)a_F+2S]^2/\sigma_u^2},\hspace{0.5cm} -(1+c)a_F+c\varepsilon \le F\le-(1-c)a_F+c\varepsilon  
\end{aligned}
\right.
\end{equation}\]</span>
则期望价格为：</p>
<p><span class="math display">\[E[P]=\int _{-a_F}^{a_F}d\varepsilon\int _{(1-c)a_F+c\varepsilon}^{(1+c)a_F+c\varepsilon}Pf(F)f(\varepsilon)dF+\int _{-a_F}^{a_F}\int _{-(1-c)a_F+c\varepsilon}^{(1-c)a_F+c\varepsilon}Pf(F)f(\varepsilon)dF+\int _{-a_F}^{a_F}d\varepsilon\int _{-(1+c)a_F+c\varepsilon}^{-(1-c)a_F+c\varepsilon}Pf(F)f(\varepsilon)dF\\
=-\frac{2\sigma_u^2c\bar \theta}{w}-\sigma_u^2(1-c)\bar\theta-(1-w)\frac{(1-c)c^2a_F^2\bar\theta}{3+wc^2a_F^2/\sigma_u^2}+(1-w)\frac{\sigma_u^2\bar\theta}{wa_F}(\frac{w}{12\sigma_u^2})^{-\frac{1}{2}}arctan(\sqrt{\frac{w}{12\sigma_u^2}2ca_F})\]</span></p>
<p>参数设定，<span class="math inline">\(a_u=a_F=2\)</span>，<span class="math inline">\(\theta=0.1\)</span>，<span class="math inline">\(w=0.5\)</span>，<span class="math inline">\(c=0.01\)</span>，具体代码如下：</p>
<pre class="r"><code>set.seed(100)
library(plyr)
theta=0.1
au&lt;-af&lt;-2
simamu=au^2/3
c=seq(0,1,0.1)
w=0.5
P=-2*simamu*c*theta/w-theta*simamu*(1-c)-(1-w)*(1-c)*c^2*af^2*theta/(3+w*c^2*af^2/simamu)+(1-w)*(simamu*theta/(w*af))*sqrt(12*simamu/w)*atan(sqrt(w/(12*simamu))*2*c*af)

condmean&lt;-function(S,c,af){
  cm&lt;-NULL
  if(S&gt;=(1-c)*af/2&amp;S&lt;=(1+c)*af/2){
    cm&lt;-((1-c)*af+2*S)/2
  }else{
    if(S&lt;=-(1-c)*af/2&amp;S&gt;=-(1+c)*af/2){
      cm&lt;-(2*S-(1-c)*af)/2
    }else{
      cm=2*S
    }
  }
  return(cm)
}

condvar&lt;-function(S,c,af){
  vr&lt;-NULL
  if(S&gt;=(1-c)*af/2&amp;S&lt;=(1+c)*af/2){
    vr&lt;-((1+c)*af-2*S)^2/12
  }else{
    if(S&lt;=-(1-c)*af/2&amp;S&gt;=-(1+c)*af/2){
      vr&lt;-((1+c)*af+2*S)^2/12
    }else{
      vr&lt;-(2*c*af)^2/12
    }
  }
  return(vr)
}


w=0.5

meanP&lt;-function(c,w){
  theta=0.1
  au&lt;-af&lt;-2
  simamu=au^2/3
  epsilon&lt;-runif(1000000,-2,2)
  df&lt;-runif(1000000,-2,2)
  S=(df-epsilon*c)/2
  VFI=laply(S,condvar,c,2)
  mP=mean(2*S+c*epsilon-theta*simamu-(1-w)*(S+c*epsilon+theta*VFI)/(1+w*VFI/simamu))
  return(data.frame(c,w,mP,me=mean(2*S+c*epsilon-theta*simamu-(1-w)*(S+c*epsilon+VFI)/(1+w*VFI/simamu))))
}

mp&lt;-ldply(c,meanP,w)

plot(c,P,lty=3,type = &quot;l&quot;)
abline(h=-theta*simamu,col=&quot;red&quot;,lty=3)
lines(mp$c,mp$mP,col=&quot;blue&quot;,lty=3)</code></pre>
<p><img src="/research/2021-01-14-etf持股影响股票定价效率的理论模型推导_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>


  <footer>
  
  



<script src="//yingjie.org/highlight.js/9.11.0/highlight.min.js"></script>



<script src="//yingjie.org/highlight.js/9.11.0/languages/r.min.js"></script>
<script src="//yingjie.org/highlight.js/9.11.0/languages/yaml.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



  
  <hr>
  <div class="copyright">© <a href="/">Yingjie Xue</a>2020| <a href="https://github.com/yingjiexue">Github</a></div>
  
  </footer>
  </article>
  
  </body>
</html>

